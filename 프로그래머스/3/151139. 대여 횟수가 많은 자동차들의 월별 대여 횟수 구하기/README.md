# [level 3] 대여 횟수가 많은 자동차들의 월별 대여 횟수 구하기 - 151139 

[문제 링크](https://school.programmers.co.kr/learn/courses/30/lessons/151139) 

### 성능 요약

메모리: 0.0 MB, 시간: 0.00 ms

### 구분

코딩테스트 연습 > GROUP BY

### 채점결과

history_idcar_idstart_dateend_date506152022-08-01 00:00:002022-08-02 00:00:00507262022-08-01 00:00:002022-11-09 00:00:00508272022-08-01 00:00:002022-08-02 00:00:00510292022-08-02 00:00:002022-08-05 00:00:00511132022-08-03 00:00:002022-08-07 00:00:00512272022-08-03 00:00:002022-08-04 00:00:00513282022-08-03 00:00:002022-08-03 00:00:0051722022-08-05 00:00:002022-08-07 00:00:0051852022-08-05 00:00:002022-08-08 00:00:00519232022-08-05 00:00:002022-08-06 00:00:00520252022-08-05 00:00:002022-08-07 00:00:00521272022-08-05 00:00:002022-08-06 00:00:0052372022-08-06 00:00:002022-08-08 00:00:0052482022-08-06 00:00:002022-08-06 00:00:0052782022-08-07 00:00:002022-08-11 00:00:00528192022-08-07 00:00:002022-09-16 00:00:00529282022-08-07 00:00:002022-08-21 00:00:00530292022-08-07 00:00:002022-08-11 00:00:00531232022-08-08 00:00:002022-08-21 00:00:00532252022-08-08 00:00:002022-08-09 00:00:0053422022-08-09 00:00:002022-08-09 00:00:0053552022-08-09 00:00:002022-08-09 00:00:00536272022-08-09 00:00:002022-08-16 00:00:0053722022-08-10 00:00:002022-08-20 00:00:0053852022-08-10 00:00:002022-08-10 00:00:0053992022-08-10 00:00:002022-08-10 00:00:00540152022-08-10 00:00:002022-09-19 00:00:00542252022-08-11 00:00:002022-08-12 00:00:0054552022-08-12 00:00:002022-09-21 00:00:0054682022-08-12 00:00:002022-08-13 00:00:00547132022-08-12 00:00:002022-08-14 00:00:00548162022-08-13 00:00:002022-08-13 00:00:00549292022-08-13 00:00:002022-08-13 00:00:0055172022-08-14 00:00:002022-08-15 00:00:00552252022-08-14 00:00:002022-08-14 00:00:0055682022-08-16 00:00:002022-08-23 00:00:0055862022-08-17 00:00:002022-09-21 00:00:00559132022-08-17 00:00:002022-08-19 00:00:00560162022-08-17 00:00:002022-11-15 00:00:00561252022-08-17 00:00:002022-08-27 00:00:0056292022-08-18 00:00:002022-08-20 00:00:0056472022-08-19 00:00:002022-08-22 00:00:00567102022-08-20 00:00:002022-08-21 00:00:0056822022-08-21 00:00:002022-08-23 00:00:00569292022-08-21 00:00:002022-11-29 00:00:0057192022-08-22 00:00:002022-10-01 00:00:0057372022-08-23 00:00:002022-09-22 00:00:00574132022-08-23 00:00:002022-08-24 00:00:0057522022-08-24 00:00:002022-08-28 00:00:00576272022-08-24 00:00:002022-09-23 00:00:00577102022-08-25 00:00:002022-08-26 00:00:00578232022-08-25 00:00:002022-09-01 00:00:00579282022-08-25 00:00:002022-09-08 00:00:0058182022-08-26 00:00:002022-08-27 00:00:00582102022-08-27 00:00:002022-08-29 00:00:00583132022-08-27 00:00:002022-09-06 00:00:0058682022-08-29 00:00:002022-08-30 00:00:00587112022-08-29 00:00:002022-08-29 00:00:0059182022-09-01 00:00:002022-09-11 00:00:00592102022-09-01 00:00:002022-09-02 00:00:00593252022-09-01 00:00:002022-09-03 00:00:00594122022-09-02 00:00:002022-09-15 00:00:00595102022-09-03 00:00:002022-09-18 00:00:00596112022-09-04 00:00:002022-09-04 00:00:00597232022-09-04 00:00:002022-09-07 00:00:0060122022-09-05 00:00:002022-10-05 00:00:00602202022-09-05 00:00:002022-09-06 00:00:00603182022-09-06 00:00:002022-09-07 00:00:00604222022-09-06 00:00:002022-09-06 00:00:00605252022-09-06 00:00:002022-09-09 00:00:00606222022-09-07 00:00:002022-12-06 00:00:00607242022-09-08 00:00:002022-09-11 00:00:00609182022-09-09 00:00:002022-09-12 00:00:00610202022-09-09 00:00:002022-09-12 00:00:00611132022-09-10 00:00:002022-09-11 00:00:0061342022-09-11 00:00:002022-10-21 00:00:00614282022-09-11 00:00:002022-09-12 00:00:00615112022-09-12 00:00:002022-09-13 00:00:00616252022-09-12 00:00:002022-09-14 00:00:0061882022-09-13 00:00:002022-09-14 00:00:00619182022-09-13 00:00:002022-09-15 00:00:00620282022-09-13 00:00:002022-12-22 00:00:00621112022-09-14 00:00:002022-09-16 00:00:00622132022-09-14 00:00:002022-09-21 00:00:00623202022-09-14 00:00:002022-09-15 00:00:00624242022-09-14 00:00:002022-09-14 00:00:00626232022-09-15 00:00:002022-09-16 00:00:0062782022-09-16 00:00:002022-09-16 00:00:00628122022-09-16 00:00:002022-09-18 00:00:00629182022-09-16 00:00:002022-10-16 00:00:00630202022-09-16 00:00:002022-10-16 00:00:0063182022-09-17 00:00:002022-09-19 00:00:00632112022-09-17 00:00:002022-09-18 00:00:00634192022-09-18 00:00:002022-09-20 00:00:00635242022-09-18 00:00:002022-10-28 00:00:00637112022-09-19 00:00:002022-09-19 00:00:00638152022-09-20 00:00:002022-09-23 00:00:00639252022-09-20 00:00:002022-09-21 00:00:0064082022-09-21 00:00:002022-09-24 00:00:00641122022-09-21 00:00:002022-09-23 00:00:00642192022-09-21 00:00:002022-09-23 00:00:00645102022-09-22 00:00:002022-09-23 00:00:00646232022-09-22 00:00:002022-09-24 00:00:0064852022-09-23 00:00:002022-11-02 00:00:0064972022-09-23 00:00:002022-10-06 00:00:00650132022-09-23 00:00:002022-09-24 00:00:0065362022-09-24 00:00:002022-10-24 00:00:00654122022-09-24 00:00:002022-09-25 00:00:00656102022-09-25 00:00:002022-09-25 00:00:00657112022-09-25 00:00:002023-01-03 00:00:00658212022-09-25 00:00:002022-09-26 00:00:00659252022-09-25 00:00:002022-09-27 00:00:00660272022-09-25 00:00:002022-12-24 00:00:00663152022-09-26 00:00:002022-09-26 00:00:00664192022-09-26 00:00:002022-10-03 00:00:00665232022-09-26 00:00:002022-10-06 00:00:00667102022-09-28 00:00:002022-10-12 00:00:00668132022-09-28 00:00:002022-09-28 00:00:00669252022-09-29 00:00:002022-10-28 00:00:00671152022-10-01 00:00:002022-10-14 00:00:00672212022-10-01 00:00:002022-10-01 00:00:0067382022-10-02 00:00:002022-10-04 00:00:00674172022-10-02 00:00:002022-11-06 00:00:0067592022-10-03 00:00:002023-01-04 00:00:00676122022-10-03 00:00:002022-10-06 00:00:00678192022-10-05 00:00:002022-11-14 00:00:00679132022-10-06 00:00:002022-10-06 00:00:0068082022-10-07 00:00:002022-10-21 00:00:00681122022-10-07 00:00:002022-11-16 00:00:00682212022-10-07 00:00:002022-10-09 00:00:0068522022-10-10 00:00:002023-01-11 00:00:0068772022-10-14 00:00:002022-11-23 00:00:00688132022-10-14 00:00:002022-10-15 00:00:00689232022-10-14 00:00:002022-10-27 00:00:00691212022-10-17 00:00:002022-10-17 00:00:00692102022-10-18 00:00:002022-10-18 00:00:00694182022-10-19 00:00:002022-10-19 00:00:00695212022-10-19 00:00:002022-10-26 00:00:00697102022-10-20 00:00:002022-10-23 00:00:0069932022-10-21 00:00:002022-10-24 00:00:00700182022-10-21 00:00:002022-10-22 00:00:00701202022-10-21 00:00:002022-10-23 00:00:00702152022-10-22 00:00:002022-11-06 00:00:0070442022-10-23 00:00:002022-10-26 00:00:0070582022-10-23 00:00:002022-10-23 00:00:00706132022-10-23 00:00:002022-10-26 00:00:00707102022-10-24 00:00:002023-01-25 00:00:0071062022-10-25 00:00:002022-10-28 00:00:0071182022-10-25 00:00:002022-10-25 00:00:00712182022-10-25 00:00:002023-01-26 00:00:0071332022-10-27 00:00:002022-10-28 00:00:0071482022-10-27 00:00:002022-11-06 00:00:00715132022-10-27 00:00:002022-10-27 00:00:00716302022-10-27 00:00:002022-10-27 00:00:00718132022-10-28 00:00:002022-10-30 00:00:0072062022-10-30 00:00:002022-11-02 00:00:00721212022-10-30 00:00:002022-11-02 00:00:0072212022-10-31 00:00:002022-11-30 00:00:0072342022-10-31 00:00:002022-11-01 00:00:00724202022-10-31 00:00:002022-12-10 00:00:00

### 제출 일자

2024년 03월 29일 01:31:01

### 문제 설명

<p>다음은 어느 자동차 대여 회사의 자동차 대여 기록 정보를 담은 <code>CAR_RENTAL_COMPANY_RENTAL_HISTORY</code> 테이블입니다. <code>CAR_RENTAL_COMPANY_RENTAL_HISTORY</code> 테이블은 아래와 같은 구조로 되어있으며, <code>HISTORY_ID</code>, <code>CAR_ID</code>, <code>START_DATE</code>, <code>END_DATE</code> 는 각각 자동차 대여 기록 ID, 자동차 ID, 대여 시작일, 대여 종료일을 나타냅니다.</p>
<table class="table">
        <thead><tr>
<th>Column name</th>
<th>Type</th>
<th>Nullable</th>
</tr>
</thead>
        <tbody><tr>
<td>HISTORY_ID</td>
<td>INTEGER</td>
<td>FALSE</td>
</tr>
<tr>
<td>CAR_ID</td>
<td>INTEGER</td>
<td>FALSE</td>
</tr>
<tr>
<td>START_DATE</td>
<td>DATE</td>
<td>FALSE</td>
</tr>
<tr>
<td>END_DATE</td>
<td>DATE</td>
<td>FALSE</td>
</tr>
</tbody>
      </table>
<hr>

<h5>문제</h5>

<p><code>CAR_RENTAL_COMPANY_RENTAL_HISTORY</code> 테이블에서 대여 시작일을 기준으로 2022년 8월부터 2022년 10월까지 총 대여 횟수가 5회 이상인 자동차들에 대해서 해당 기간 동안의 월별 자동차 ID 별 총 대여 횟수(컬럼명: <code>RECORDS</code>) 리스트를 출력하는 SQL문을 작성해주세요. 결과는 월을 기준으로 오름차순 정렬하고, 월이 같다면 자동차 ID를 기준으로 내림차순 정렬해주세요. 특정 월의 총 대여 횟수가 0인 경우에는 결과에서 제외해주세요.</p>

<hr>

<h5>예시</h5>

<p>예를 들어 <code>CAR_RENTAL_COMPANY_RENTAL_HISTORY</code> 테이블이 다음과 같다면</p>
<table class="table">
        <thead><tr>
<th>HISTORY_ID</th>
<th>CAR_ID</th>
<th>START_DATE</th>
<th>END_DATE</th>
</tr>
</thead>
        <tbody><tr>
<td>1</td>
<td>1</td>
<td>2022-07-27</td>
<td>2022-08-02</td>
</tr>
<tr>
<td>2</td>
<td>1</td>
<td>2022-08-03</td>
<td>2022-08-04</td>
</tr>
<tr>
<td>3</td>
<td>2</td>
<td>2022-08-05</td>
<td>2022-08-05</td>
</tr>
<tr>
<td>4</td>
<td>2</td>
<td>2022-08-09</td>
<td>2022-08-12</td>
</tr>
<tr>
<td>5</td>
<td>3</td>
<td>2022-09-16</td>
<td>2022-10-15</td>
</tr>
<tr>
<td>6</td>
<td>1</td>
<td>2022-08-24</td>
<td>2022-08-30</td>
</tr>
<tr>
<td>7</td>
<td>3</td>
<td>2022-10-16</td>
<td>2022-10-19</td>
</tr>
<tr>
<td>8</td>
<td>1</td>
<td>2022-09-03</td>
<td>2022-09-07</td>
</tr>
<tr>
<td>9</td>
<td>1</td>
<td>2022-09-18</td>
<td>2022-09-19</td>
</tr>
<tr>
<td>10</td>
<td>2</td>
<td>2022-09-08</td>
<td>2022-09-10</td>
</tr>
<tr>
<td>11</td>
<td>2</td>
<td>2022-10-16</td>
<td>2022-10-19</td>
</tr>
<tr>
<td>12</td>
<td>1</td>
<td>2022-09-29</td>
<td>2022-10-06</td>
</tr>
<tr>
<td>13</td>
<td>2</td>
<td>2022-10-30</td>
<td>2022-11-01</td>
</tr>
<tr>
<td>14</td>
<td>2</td>
<td>2022-11-05</td>
<td>2022-11-05</td>
</tr>
<tr>
<td>15</td>
<td>3</td>
<td>2022-11-11</td>
<td>2022-11-11</td>
</tr>
</tbody>
      </table>
<p>대여 시작일을 기준으로 총 대여 횟수가 5회 이상인 자동차는 자동차 ID가 1, 2인 자동차입니다. 월 별 자동차 ID별 총 대여 횟수를 구하고 월 오름차순, 자동차 ID 내림차순으로 정렬하면 다음과 같이 나와야 합니다.</p>
<table class="table">
        <thead><tr>
<th>MONTH</th>
<th>CAR_ID</th>
<th>RECORDS</th>
</tr>
</thead>
        <tbody><tr>
<td>8</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>8</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>9</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>9</td>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td>10</td>
<td>2</td>
<td>2</td>
</tr>
</tbody>
      </table>

> 출처: 프로그래머스 코딩 테스트 연습, https://school.programmers.co.kr/learn/challenges